@model List<ElExitoS.Models.DetalleFactura>
using ElExitoS.Models;

@{
    ViewData["Title"] = "Detalle de Factura";
    var factura = ViewBag.Factura as ElExitoS.Models.Factura;
}

<div class="d-flex justify-content-between align-items-center mb-3">
    <h2>Detalle de Factura #@factura?.Id</h2>
    <a asp-controller="Factura" asp-action="Index" class="btn btn-secondary">← Volver al Historial</a>
</div>

<div class="card mb-4">
    <div class="card-header bg-dark text-white">
        <strong>Información General</strong>
    </div>
    <div class="card-body">
        <p><strong>Cliente:</strong> @factura?.NombreCliente</p>
        <p><strong>Fecha:</strong> @factura?.Fecha.ToString("dd/MM/yyyy HH:mm")</p>
        <p><strong>Factura #:</strong> @factura?.Id</p>
    </div>
</div>

<h5>Líneas de Detalle</h5>
<table class="table table-bordered table-striped">
    <thead class="table-dark">
        <tr>
            <th>Producto</th>
            <th class="text-center">Cantidad</th>
            <th class="text-end">Precio Unitario</th>
            <th class="text-end">Subtotal Línea</th>
        </tr>
    </thead>
    <tbody>
        @foreach (var detalle in Model)
        {
            <tr>
                <td>@detalle.NombreProducto</td>
                <td class="text-center">@detalle.Cantidad</td>
                <td class="text-end">@detalle.PrecioUnitario.ToString("C")</td>
                <td class="text-end">@detalle.Subtotal.ToString("C")</td>
            </tr>
        }
    </tbody>
    <tfoot class="table-light">
        <tr>
            <td colspan="3" class="text-end"><strong>Subtotal:</strong></td>
            <td class="text-end">@factura?.Subtotal.ToString("C")</td>
        </tr>
        <tr>
            <td colspan="3" class="text-end"><strong>Impuesto (13%):</strong></td>
            <td class="text-end">@factura?.Impuesto.ToString("C")</td>
        </tr>
        <tr class="table-success">
            <td colspan="3" class="text-end"><strong>TOTAL:</strong></td>
            <td class="text-end"><strong>@factura?.Total.ToString("C")</strong></td>
        </tr>
    </tfoot>
</table>

<div class="d-flex justify-content-end">
    <a asp-controller="Factura" asp-action="Print" asp-route-id="@factura?.Id" class="btn btn-primary">
        <i class="bi bi-printer"></i> Imprimir Factura
    </a>
</div>
